(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{152:function(e,t,a){"use strict";var r={checkAuth:function(e){var t=localStorage.getItem("isTenantAdmin"),a=localStorage.getItem("ms_userRight");return!parseInt(t)&&!(a&&-1<a.indexOf(e))},timeAddZero:function(e){return e<10?"0"+e:""+e},dateFormat:function(e,t){if(e&&t){var a=e.getFullYear(),r=e.getMonth()<9?"0"+parseInt(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate(),i=e.getHours()<10?"0"+e.getHours():e.getHours(),s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();switch(t){case"yy-mm-dd h:m:s":return a+"-"+r+"-"+n+" "+i+":"+s+":"+o;case"yy-mm-dd h:m":return a+"-"+r+"-"+n+" "+i+":"+s;case"yy-mm-dd":return a+"-"+r+"-"+n;case"mm-dd h:m":return r+"-"+n+" "+i+":"+s;case"mm-dd":return r+"-"+n;case"h:m":return i+":"+s;case"h:m:s":return i+":"+s+":"+o;case"HH:mm MM/dd/yyyy":return i+":"+s+" "+r+"/"+n+"/"+a;case"mm-dd d":return r+"月"+n+" "+["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][e.getDay()]}}},getDate:function(e,t){if(e&&t){var a=(e=new Date(1e3*e)).getFullYear(),r=e.getMonth()<9?"0"+parseInt(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate();switch(t){case"yy-mm-dd":return a+"-"+r+"-"+n}}},getTime:function(e,t){if(e&&t){var a=(e=new Date(1e3*e)).getFullYear(),r=e.getMonth()<9?"0"+parseInt(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate(),i=e.getHours()<10?"0"+e.getHours():e.getHours(),s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();switch(t){case"yy-mm-dd h:m:s":return a+"-"+r+"-"+n+" "+i+":"+s+":"+o}}},getTimestamp:function(e){if(e)return e.getTime()},getSeconds:function(e){if(e)return 60*e.getHours()*60+60*e.getMinutes()+e.getSeconds()},copyText:function(e){var t=document.createRange();t.selectNode(e);var a=window.getSelection();0<a.rangeCount&&a.removeAllRanges(),a.addRange(t),document.execCommand("Copy")},setCookie:function(e,t,a){var r=new Date;r.setTime(r.getTime()+60*a*60*1e3),document.cookie=e+"="+escape(t)+(null==a?"":";expires="+r.toGMTString())},getCookie:function(e){if(0<document.cookie.length){var t=document.cookie.indexOf(e+"=");if(-1!=t){t=t+e.length+1;var a=document.cookie.indexOf(";",t);return-1==a&&(a=document.cookie.length),unescape(document.cookie.substring(t,a))}}return""},delCookie:function(e){var t=new Date;t.setTime(t.getTime()-1);var a=this.getCookie(e);null!=a&&(document.cookie=e+"="+a+";expires="+t.toGMTString())}};t.a=r},174:function(e,t,a){},242:function(e,t,a){"use strict";var r=a(174);a.n(r).a},263:function(e,t,a){"use strict";a.r(t);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"u-padding-top-xs"},[a("el-row",[a("el-form",{attrs:{inline:""}},[a("el-form-item",[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyyMMdd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.filterDate,callback:function(e){t.filterDate=e},expression:"filterDate"}})],1),t._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"状态"},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}},[a("el-option",{key:2,attrs:{label:"所有",value:2}}),t._v(" "),a("el-option",{key:1,attrs:{label:"展示中",value:1}}),t._v(" "),a("el-option",{key:0,attrs:{label:"待展示",value:0}})],1)],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"焦点图标题"},model:{value:t.filters.newsTitle,callback:function(e){t.$set(t.filters,"newsTitle",e)},expression:"filters.newsTitle"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleNew}},[t._v("添加")])],1),t._v(" "),t.$route.query.name?a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.goBack}},[t._v(t._s(t.$route.query.name))])],1):t._e()],1)],1),t._v(" "),a("el-row",[a("table-list",{attrs:{align:"center",tableData:t.tableData,columns:t.columns,pagination:t.pagination},on:{handleCurrentChange:t.handleCurrentChange,handleSizeChange:t.handleSizeChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.title,width:"620px",visible:t.dialogVisible},on:{closed:function(e){t.handleClose("form")},"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.createForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"标题",prop:"focusTitle"}},[a("el-input",{attrs:{placeholder:"请输入焦点图标题"},model:{value:t.createForm.focusTitle,callback:function(e){t.$set(t.createForm,"focusTitle",e)},expression:"createForm.focusTitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"链接",prop:"link"}},[a("el-input",{attrs:{placeholder:"活动地址act://id; 非遗go地址news://id; 非遗圈地址group://id"},model:{value:t.createForm.link,callback:function(e){t.$set(t.createForm,"link",e)},expression:"createForm.link"}})],1),t._v(" "),a("el-form-item",{staticClass:"focus",attrs:{label:"图标",prop:"focusImageUrl"}},[a("div",{staticClass:"avatar-uploader"},[a("div",{staticClass:"avatar-uploader"},[a("div",{staticClass:"el-upload el-upload--text"},[a("keep-alive",[a("Cropper",{ref:"imgCrop",attrs:{uploadUrl:t.uploadUrl,maxFileSize:2097152,extensions:"png,gif,jpeg,jpg",aspectRatio:16/9},on:{imageuploaded:t.handleAvatarSuccess,imageuploadedError:t.imageuploadedError}})],1),t._v(" "),t.createForm.focusImageUrl?a("img",{staticClass:"avatar",attrs:{src:t.createForm.focusImageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)])]),t._v(" "),a("div",{staticClass:"tips"},[t._v("请上传2M以内的JPG/JPEG/PNG/GIF图片")])])],1),t._v(" "),a("div",{staticClass:"text-center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)],1)],1)};r._withStripped=!0;var n=a(5),i=a.n(n),s=a(151),o=a(153),l=a(152),u={computed:{uploadUrl:function(){return o.c+"/admin/focus/goUpload"}},components:{Cropper:a(158).a},data:function(){var r=this;this.$createElement;return{filterDate:"",filters:{source:this.$route.query.type?this.$route.query.type:0,newsTitle:null,status:null,startDate:null,endDate:null},dialogVisible:!1,title:null,createForm:{focusImageUrl:null,focusTitle:null,link:null},tableData:[],operatorId:null,rules:{focusTitle:[{required:!0,message:"请输入焦点图标题",trigger:["change","blur"]}],link:[{required:!0,message:"请输入链接",trigger:["change","blur"]}],focusImageUrl:[{required:!0,message:"请上传焦点图",trigger:["change","blur"]}]},columns:[{prop:"sortId",label:"调序",render:function(e,t,a){return a("div",[a("el-button",{attrs:{size:"small",disabled:0==t,icon:"el-icon-arrow-up",circle:!0},on:{click:function(){return r.sort("up",e,t)}}}),a("el-button",{attrs:{size:"small",disabled:t==r.tableData.length-1,icon:"el-icon-arrow-down",circle:!0},on:{click:function(){return r.sort("down",e,t)}}})])}},{prop:"id",label:"ID"},{prop:"title",label:"焦点图标题"},{prop:"link",label:"焦点图链接"},{prop:"createby",label:"创建人"},{prop:"createat",label:"创建时间",render:function(e,t,a){return a("div",[l.a.getTime(e.createat,"yy-mm-dd h:m:s")])}},{prop:"status",label:"状态",render:function(e,t,a){return a("div",[1==e.status?"展示中":"待展示"])}},{prop:"operator",label:"操作",render:function(t,e,a){return a("div",[a("el-dropdown",{on:{command:function(e){return r.handleCommand(e,t)}}},[a("span",{class:"el-dropdown-link"},[a("i",{class:"el-icon-setting el-icon--right"})]),a("el-dropdown-menu",{slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"1"}},["编辑"]),a("el-dropdown-item",{attrs:{command:"2"}},[t.status?"下架":"上架"])])])])}}],pagination:{current_page:1,total:0,page_size:10,page_sizes:[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",background:!0,prevText:"上一页",nextText:"下一页"}}},created:function(){this.getList()},methods:{goBack:function(){this.$router.push({name:"produce",params:{activeName:this.$route.query.type}})},handleSearch:function(){this.getList()},handleAvatarSuccess:function(e,t){this.createForm.focusImageUrl=o.b+e.data.url},imageuploadedError:function(e){this.$message({type:"error",message:e})},getList:function(){var t=this;this.filterDate&&0<this.filterDate.length?(this.filters.startDate=this.filterDate[0],this.filters.endDate=this.filterDate[1]):(this.filters.startDate=null,this.filters.endDate=null);var e=i()({page:this.pagination.current_page,pageSize:this.pagination.page_size},this.filters);Object(s.C)(e).then(function(e){t.tableData=e.data.focuslist,t.pagination.total=e.data.total})},handleSizeChange:function(e){this.pagination.page_size=e,this.getList()},handleCurrentChange:function(e){this.pagination.current_page=e,this.getList()},sort:function(e,t,a){var r=this,n={};n="up"==e?{nowId:t.id,nowNumber:t.ordernumber,newId:this.tableData[a-1].id,newNumber:this.tableData[a-1].ordernumber}:{nowId:t.id,nowNumber:t.ordernumber,newId:this.tableData[a+1].id,newNumber:this.tableData[a+1].ordernumber},Object(s.ib)(n).then(function(e){r.$message({type:"success",message:"调序成功"}),r.getList()})},handleCommand:function(e,t){var a=this;this.operatorId=t.id,1==e?(this.title="编辑焦点图",this.dialogVisible=!0,this.$nextTick(function(){a.createForm={focusImageUrl:t.imgurl,focusTitle:t.title,link:t.link}})):2==e&&(t.status?this.handleOffshelve():this.handleShelve())},handleShelve:function(){var t=this,e={id:this.operatorId};Object(s.cb)(e).then(function(e){t.$message({type:"success",message:"上架成功"}),t.getList()})},handleOffshelve:function(){var t=this,e={id:this.operatorId};Object(s.f)(e).then(function(e){t.$message({type:"success",message:"下架成功"}),t.getList()})},handleSubmit:function(){var a=this;this.$refs.form.validate(function(e){if(e){var t=i()({},a.createForm,{id:a.operatorId});a.operatorId?Object(s.o)(t).then(function(e){a.dialogVisible=!1,a.$message({type:"success",message:"编辑成功"}),a.getList()}):Object(s.S)(t).then(function(e){a.dialogVisible=!1,a.$message({type:"success",message:"添加成功"}),a.getList()})}})},handleNew:function(){this.title="添加焦点图",this.dialogVisible=!0},handleClose:function(e){this.$refs[e].resetFields(),this.operatorId=null}}},c=(a(242),a(1)),d=Object(c.a)(u,r,[],!1,null,null,null);d.options.__file="src/views/edit/focus.vue";t.default=d.exports}}]);