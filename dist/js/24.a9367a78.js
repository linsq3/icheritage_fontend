(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{167:function(e,t,a){},235:function(e,t,a){"use strict";var n=a(167);a.n(n).a},261:function(e,t,a){"use strict";a.r(t);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"u-padding-top-xs"},[a("el-row",[a("el-form",{attrs:{inline:""}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleNew}},[t._v("添加")])],1)],1)],1),t._v(" "),a("el-row",[a("table-list",{attrs:{align:"center",tableData:t.tableData,columns:t.columns,pagination:t.pagination},on:{handleCurrentChange:t.handleCurrentChange,handleSizeChange:t.handleSizeChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.title,width:"620px",visible:t.dialogVisible},on:{closed:function(e){t.handleClose("form")},"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.createForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"菜单名称",prop:"menuName"}},[a("el-input",{attrs:{placeholder:"请输入菜单名称"},model:{value:t.createForm.menuName,callback:function(e){t.$set(t.createForm,"menuName",e)},expression:"createForm.menuName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"父菜单",prop:"menuClass"}},[a("el-select",{attrs:{placeholder:"默认"},model:{value:t.createForm.menuClass,callback:function(e){t.$set(t.createForm,"menuClass",e)},expression:"createForm.menuClass"}},[a("el-option",{key:1,attrs:{label:"非遗go",value:"非遗go"}}),t._v(" "),a("el-option",{key:2,attrs:{label:"活动",value:"活动"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"图标",prop:"logo"}},[a("div",{staticClass:"avatar-uploader"},[a("div",{staticClass:"avatar-uploader"},[a("div",{staticClass:"el-upload el-upload--text"},[a("keep-alive",[a("Cropper",{ref:"imgCrop",attrs:{uploadUrl:t.uploadUrl,maxFileSize:2097152,extensions:"png,gif,jpeg,jpg",aspectRatio:1},on:{imageuploaded:t.handleAvatarSuccess,imageuploadedError:t.imageuploadedError}})],1),t._v(" "),t.createForm.logo?a("img",{staticClass:"avatar",attrs:{src:t.createForm.logo}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)])]),t._v(" "),a("div",{staticClass:"tips"},[t._v("请上传2M以内的JPG/JPEG/PNG/GIF图片")])])],1),t._v(" "),a("div",{staticClass:"text-center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)],1)],1)};n._withStripped=!0;var i=a(5),l=a.n(i),o=a(151),r=a(153),s={computed:{uploadUrl:function(){return r.c+"/admin/menu/upload"}},components:{Cropper:a(158).a},data:function(){var n=this;this.$createElement;return{dialogVisible:!1,title:null,createForm:{menuName:null,menuClass:null,logo:null},tableData:[],operatorId:null,rules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:["change","blur"]}],menuClass:[{required:!0,message:"请选择父菜单",trigger:["change","blur"]}],logo:[{required:!0,message:"请上传图片",trigger:["change","blur"]}]},columns:[{prop:"menuName",label:"菜单名称"},{prop:"menuImg",label:"菜单图标",render:function(e,t,a){return a("div",[a("img",{class:"menu-img",attrs:{src:e.menuImg}})])}},{prop:"menuType",label:"父菜单"},{prop:"operator",label:"操作",render:function(t,e,a){return a("div",[a("el-dropdown",{on:{command:function(e){return n.handleCommand(e,t)}}},[a("span",{class:"el-dropdown-link"},[a("i",{class:"el-icon-setting el-icon--right"})]),a("el-dropdown-menu",{slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"1"}},["编辑"]),a("el-dropdown-item",{attrs:{command:"2"}},["删除"])])])])}}],pagination:{current_page:1,total:0,page_size:10,page_sizes:[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",background:!0,prevText:"上一页",nextText:"下一页"}}},created:function(){this.getList()},methods:{handleAvatarSuccess:function(e,t){this.createForm.logo=r.b+e.data.url},imageuploadedError:function(e){this.$message({type:"error",message:e})},getList:function(){var t=this,e={page:this.pagination.current_page,pageSize:this.pagination.page_size};Object(o.E)(e).then(function(e){t.tableData=e.data.menulist,t.pagination.total=e.data.total})},handleSizeChange:function(e){this.pagination.page_size=e,this.getList()},handleCurrentChange:function(e){this.pagination.current_page=e,this.getList()},handleCommand:function(e,t){var a=this;this.operatorId=t.id,1==e?(this.title="编辑菜单",this.dialogVisible=!0,this.$nextTick(function(){a.createForm={menuName:t.menuName,menuClass:t.menuType,logo:t.menuImg}})):2==e&&this.handleDel()},handleDel:function(){var t=this,e={id:this.operatorId};Object(o.h)(e).then(function(e){t.$message({type:"success",message:"删除成功"}),t.getList()})},handleSubmit:function(){var a=this;this.$refs.form.validate(function(e){if(e){var t=l()({},a.createForm,{id:a.operatorId});a.operatorId?Object(o.r)(t).then(function(e){a.dialogVisible=!1,a.$message({type:"success",message:"编辑成功"}),a.getList()}):Object(o.U)(t).then(function(e){a.dialogVisible=!1,a.$message({type:"success",message:"添加成功"}),a.getList()})}})},handleNew:function(){this.title="添加菜单",this.dialogVisible=!0},handleClose:function(e){this.$refs[e].resetFields(),this.operatorId=null}}},u=(a(235),a(1)),c=Object(u.a)(s,n,[],!1,null,null,null);c.options.__file="src/views/system/menu.vue";t.default=c.exports}}]);